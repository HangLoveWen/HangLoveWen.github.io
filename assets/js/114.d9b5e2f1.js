(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{511:function(e,s,o){"use strict";o.r(s);var v=o(2),_=Object(v.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("1.安装express-session中间件")]),e._v(" "),s("p",[e._v("在express项目中，只需要安装express-session中间件，即可在项目中号使用Session认证：")]),e._v(" "),s("p",[s("code",[e._v("npm install express-session")])]),e._v(" "),s("p",[e._v("2.配置express-session")]),e._v(" "),s("p",[e._v("express-session中间件安装完成后，需要通过app.use()来注册session中间件，示例代码如下")]),e._v(" "),s("p",[s("code",[e._v("const session=require('express-session')")])]),e._v(" "),s("p",[s("code",[e._v("const express=require('express')")])]),e._v(" "),s("p",[s("code",[e._v("const app=express()")])]),e._v(" "),s("p",[s("code",[e._v("app.use(session({")])]),e._v(" "),s("p",[s("code",[e._v("secret:'acd',")])]),e._v(" "),s("p",[s("code",[e._v("resave:false,")])]),e._v(" "),s("p",[s("code",[e._v("saveUninitialized:true,")])]),e._v(" "),s("p",[s("code",[e._v("}")])]),e._v(" "),s("p",[s("code",[e._v("))")])]),e._v(" "),s("p",[e._v("3.向session中存数据")]),e._v(" "),s("p",[e._v("当expess-session中间件配置成功后，即可使用req.session来访问和使用session对象，从而存储用户的关键信息：")]),e._v(" "),s("p",[s("code",[e._v("const session=require('express-session')")])]),e._v(" "),s("p",[s("code",[e._v("const express=require('express')")])]),e._v(" "),s("p",[s("code",[e._v("const app=express()")])]),e._v(" "),s("p",[s("code",[e._v("app.use(express.json())")])]),e._v(" "),s("p",[s("code",[e._v("app.use(express.urlencoded({extended:true}))")])]),e._v(" "),s("p",[s("code",[e._v("app.use(session({")])]),e._v(" "),s("p",[s("code",[e._v("secret:'acd',")])]),e._v(" "),s("p",[s("code",[e._v("resave:false,")])]),e._v(" "),s("p",[s("code",[e._v("saveUninitialized:true,")])]),e._v(" "),s("p",[s("code",[e._v("}")])]),e._v(" "),s("p",[s("code",[e._v("))")])]),e._v(" "),s("p",[s("code",[e._v("app.post('/login',(req,res)=>{")])]),e._v(" "),s("p",[s("code",[e._v("if(req.body.username!==\"admin\"||req.body.password!=='000000'){")])]),e._v(" "),s("p",[s("code",[e._v("return res.send({status:1,msg:'登录失败'})")])]),e._v(" "),s("p",[s("code",[e._v("}")])]),e._v(" "),s("p",[s("code",[e._v("req.session.user=req.body")])]),e._v(" "),s("p",[s("code",[e._v("req.session.islogin=true")])]),e._v(" "),s("p",[s("code",[e._v("res.send({status:0,msg:'登陆成功'})")])]),e._v(" "),s("p",[s("code",[e._v("})")])]),e._v(" "),s("p",[s("code",[e._v("app.listen(80,()=>{")])]),e._v(" "),s("p",[s("code",[e._v("console.log('seer running on http://localhost:80')")])]),e._v(" "),s("p",[s("code",[e._v("})")])]),e._v(" "),s("p",[e._v("4.从session中取数据")]),e._v(" "),s("p",[e._v("可以直接从req.session对象上获取之前存储的数据，示例代码如下：")]),e._v(" "),s("p",[s("code",[e._v("app.get('/username',(req,res)=>{")])]),e._v(" "),s("p",[s("code",[e._v("if(req.session.islogin!=true){")])]),e._v(" "),s("p",[s("code",[e._v("return res.send({status:1,msg:'session获取失败'})")])]),e._v(" "),s("p",[s("code",[e._v("}")])]),e._v(" "),s("p",[s("code",[e._v("res.send({status:0,msg:req.session.user.username})")])]),e._v(" "),s("p",[s("code",[e._v("})")])]),e._v(" "),s("p",[e._v("5.清空session")]),e._v(" "),s("p",[e._v("调用req.session.destory()函数，即可清空服务器保存的session信息。")]),e._v(" "),s("p",[s("code",[e._v("app.post('/logout',(req,res)=>{")])]),e._v(" "),s("p",[s("code",[e._v("req.session.destroy()")])]),e._v(" "),s("p",[s("code",[e._v("res.send({status:0,masg:'退出成功！'})")])]),e._v(" "),s("p",[s("code",[e._v("})")])])])}),[],!1,null,null,null);s.default=_.exports}}]);